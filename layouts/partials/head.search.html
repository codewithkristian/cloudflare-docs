{{/* @see :: data/<name>.yml */}}
{{- $DATA := (index .Context.Site.Data .Product) -}}
{{- $algolia := $DATA.algolia -}}

{{- if $algolia -}}
  <script defer async src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.js"></script>

  {{/* modified "script" partial */}}
  {{- $opts := dict "target" "es2015" "minify" hugo.IsProduction "format" "iife" -}}
  {{- $script := (resources.Get "search.ts") | js.Build $opts -}}

  {{- if hugo.IsProduction -}}
    {{- $script = $script | minify | fingerprint "md5" -}}
  {{- end -}}

  <script
    src="{{ $script.RelPermalink }}" defer
    data-filters="{{ $algolia.filters }}"
    data-index="{{ $algolia.index }}"
    data-key="{{ $algolia.apikey }}"
  ></script>
{{- end -}}